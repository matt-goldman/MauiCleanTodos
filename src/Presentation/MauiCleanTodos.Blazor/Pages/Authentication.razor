@page "/authentication/{action}"
@inject IAccessTokenProvider tokenProvider

@using MauiCleanTodos.ApiClient.Authentication;
@using Microsoft.AspNetCore.Components.WebAssembly.Authentication
<RemoteAuthenticatorView Action="@Action" OnLogInSucceeded="HandleLoginSucceeded" />

@code{
    [Parameter] public string? Action { get; set; }

    public async void HandleLoginSucceeded()
    {
        var tokenResult = await tokenProvider.RequestAccessToken();

        if (tokenResult.TryGetToken(out var token))
        {
            AuthHandler.SetAccessToken(token.Value);
        }
        else
        {
            Console.WriteLine("No token");
        }
    }
}
